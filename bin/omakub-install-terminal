#!/bin/bash

if (($# == 0)); then
  echo "Usage: omakub-install-terminal [alacritty|kitty]"
  exit 1
fi

package="$1"

# Map package name to desktop entry ID
case "$package" in
alacritty) desktop_id="Alacritty.desktop" ;;
kitty) desktop_id="kitty.desktop" ;;
*)
  echo "Unknown terminal: $package"
  exit 1
  ;;
esac

# Install package
if omakub-app-install "$package"; then
  # Set as default terminal
  echo "Setting $package as new default terminal..."
  omakub-env-set TERMINAL "$package"

  # Update ubuntu-xdg-terminals.list to prioritize the proper terminal
  cat > ~/.config/ubuntu-xdg-terminals.list << EOF
# Terminal emulator preference order for xdg-terminal-exec
# The first found and valid terminal will be used
$desktop_id
EOF
else
  echo "Failed to install $package."
  exit 1
fi
